# ğŸ—ï¸ ARQUITETURA SISALMOX - VISÃƒO GERAL

## ğŸ“¦ Estrutura de Banco de Dados (PostgreSQL no Railway)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SISALMOX DATABASE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    PRODUTOS          â”‚  â”‚   CATEGORIAS         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)              â”‚  â”‚ id (PK)              â”‚
â”‚ nome                 â”‚  â”‚ nome                 â”‚
â”‚ categoria_id (FK)    â”‚â—„â”€â”€â”¤ descricao           â”‚
â”‚ unidade_id (FK)      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ tipo_controle*       â”‚
â”‚ preco_unitario       â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ fk_secao (FK)        â”‚â—„â”€â”€â”€â”€â”€â”¤ UNIDADES             â”‚
â”‚ descricao            â”‚      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ativo                â”‚      â”‚ id (PK)              â”‚
â”‚ created_at           â”‚      â”‚ nome                 â”‚
â”‚ updated_at           â”‚      â”‚ sigla                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–³                               â–³
         â”‚                               â”‚
    FK [tipo_controle = 'consumo']  [one-to-many]
    FK [tipo_controle = 'permanente']

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ITENS_ESTOQUE       â”‚  â”‚ ITENS_PATRIMONIAIS   â”‚
â”‚  (ConsumÃ­veis)       â”‚  â”‚ (Permanentes)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)              â”‚  â”‚ id (PK)              â”‚
â”‚ fk_produto (FK)      â”‚  â”‚ fk_produto (FK)      â”‚
â”‚ fk_secao (FK)        â”‚  â”‚ numero_patrimonial   â”‚
â”‚ quantidade           â”‚  â”‚ fk_secao (FK)        â”‚
â”‚ quantidade_cautelada â”‚  â”‚ valor_aquisicao      â”‚
â”‚ preco_unitario       â”‚  â”‚ data_aquisicao       â”‚
â”‚ valor_total          â”‚  â”‚ created_at           â”‚
â”‚ data_entrada         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ observacoes          â”‚
â”‚ created_at           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â”‚                       â”‚
         â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
             â”‚                 â”‚
             â–¼                 â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ ESTOQUE_UNIFICADOâ”‚ (VIEW)
      â”‚ (UNION Query)    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ EstoqueUnificado  â”‚
     â”‚ Service           â”‚
     â”‚ (Aggregates)      â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ listarEstoque View  â”‚
    â”‚ (Blade Template)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CAUTELAS           â”‚  â”‚ CAUTELA_PRODUTO      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)              â”‚  â”‚ id (PK)              â”‚
â”‚ numero               â”‚  â”‚ cautela_id (FK)      â”‚
â”‚ data_cautela         â”‚  â”‚ fk_produto (FK)      â”‚
â”‚ responsavel_unidade  â”‚  â”‚ quantidade           â”‚
â”‚ observacoes          â”‚  â”‚ devolucao_data       â”‚
â”‚ created_at           â”‚  â”‚ devolucao_quantidade â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜
              â”‚                â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                    (tracks)
                       â”‚
                       â–¼
             QUANTIDADE_CAUTELADA
             (Em itens_estoque)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    SECOES            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)              â”‚
â”‚ nome                 â”‚
â”‚ sigla                â”‚
â”‚ descricao            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–³
         â”‚
      [one-to-many]
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚          â”‚
    â–¼          â–¼
 [itens]   [produtos]
```

## ğŸ”„ Fluxo de Dados - VisualizaÃ§Ã£o Unificada

```
REQUEST: GET /registros/estoque/listar
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EstoqueController              â”‚
â”‚ â””â”€ listarEstoque()             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EstoqueUnificadoService        â”‚
â”‚ â””â”€ obterEstoqueUnificado()     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UNION Query                    â”‚
â”‚                                â”‚
â”‚ SELECT * FROM itens_estoque    â”‚
â”‚ UNION                          â”‚
â”‚ SELECT * FROM itens_patrimoniais
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Aggregation                    â”‚
â”‚                                â”‚
â”‚ GROUP BY fk_produto            â”‚
â”‚ SUM(quantidade)                â”‚
â”‚ AVG(preco_unitario)            â”‚
â”‚ SUM(quantidade_cautelada)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Format Response                â”‚
â”‚                                â”‚
â”‚ - Paginate (15 per page)       â”‚
â”‚ - Add unidades names           â”‚
â”‚ - Add categorias names         â”‚
â”‚ - Calculate disponÃ­vel         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Blade Template                 â”‚
â”‚ listarEstoque.blade.php        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    HTML Response
    â””â”€ Tabela com:
       â”œâ”€ Produto (link â†’ detalhes)
       â”œâ”€ LocalizaÃ§Ã£o (2 seÃ§Ãµes + count)
       â”œâ”€ PatrimÃ´nio (para items permanentes)
       â”œâ”€ DisponÃ­vel (qty - cautelado)
       â”œâ”€ Cautelado (yellow badge)
       â”œâ”€ Quantidade (total)
       â”œâ”€ Unidade
       â”œâ”€ Categoria
       â”œâ”€ Valor MÃ©dio
       â”œâ”€ Subtotal
       â””â”€ TransferÃªncia (modal)
```

## ğŸ”Œ APIs e Endpoints

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    WEB ROUTES - INVENTORY                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GET  /registros/estoque/listar
     â””â”€ EstoqueController@listarEstoque
     â””â”€ View: listarEstoque.blade.php
     â””â”€ Unified list with aggregation

GET  /registros/estoque/unificado
     â””â”€ EstoqueController@listarUnificado
     â””â”€ View: listarUnificado.blade.php
     â””â”€ Alternative unified view

GET  /registros/estoque/detalhes/{id}
     â””â”€ EstoqueController@detalhes
     â””â”€ Shows breakdown by section

POST /estoque/transferencia-secoes
     â””â”€ EstoqueController@transferirEntreSeccoes
     â””â”€ Validates and processes transfers

GET  /estoque/entrada
     â””â”€ EstoqueController@showEntrada
     â””â”€ Form for new items

POST /estoque/entrada
     â””â”€ EstoqueController@entradaEstoque
     â””â”€ Process item entry

GET  /cautelas
     â””â”€ CautelaController@index
     â””â”€ List all cautelas

POST /cautelas/store
     â””â”€ CautelaController@store
     â””â”€ Create new cautela

GET  /cautelas/{id}/pdf
     â””â”€ CautelaController@downloadPdf
     â””â”€ Generate PDF
```

## ğŸ“± Frontend Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BLADE TEMPLATES (resources/views)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”œâ”€ estoque/                                                â”‚
â”‚  â”‚  â”œâ”€ listarEstoque.blade.php (Main List)                 â”‚
â”‚  â”‚  â”‚  â”œâ”€ Table with pagination                            â”‚
â”‚  â”‚  â”‚  â”œâ”€ Transfer modal                                   â”‚
â”‚  â”‚  â”‚  â”œâ”€ Search & filters                                 â”‚
â”‚  â”‚  â”‚  â””â”€ Value calculations                               â”‚
â”‚  â”‚  â”‚                                                       â”‚
â”‚  â”‚  â”œâ”€ listarUnificado.blade.php (Alternative View)        â”‚
â”‚  â”‚  â”‚  â””â”€ Same data, different layout                      â”‚
â”‚  â”‚  â”‚                                                       â”‚
â”‚  â”‚  â”œâ”€ detalhes.blade.php                                  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Product details                                  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Location breakdown                               â”‚
â”‚  â”‚  â”‚  â””â”€ Section quantities                               â”‚
â”‚  â”‚  â”‚                                                       â”‚
â”‚  â”‚  â””â”€ entrada.blade.php                                   â”‚
â”‚  â”‚     â””â”€ Form for new items                               â”‚
â”‚  â”‚                                                          â”‚
â”‚  â””â”€ cautela/                                                â”‚
â”‚     â”œâ”€ index.blade.php                                      â”‚
â”‚     â””â”€ create.blade.php                                     â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CSS/JS ASSETS                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”œâ”€ Bootstrap 4 (Grid, Forms, Modals)                      â”‚
â”‚  â”œâ”€ Font Awesome (Icons)                                    â”‚
â”‚  â”œâ”€ jQuery (DOM manipulation)                              â”‚
â”‚  â””â”€ Custom JS (Form validation, AJAX)                      â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Authentication & Security

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LARAVEL SANCTUM                           â”‚
â”‚                  (API Authentication)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€ Session-based (Web)
     â”‚  â””â”€ Traditional cookies
     â”‚
     â””â”€ Token-based (API)
        â””â”€ Bearer tokens

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MIDDLEWARE STACK                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”œâ”€ EncryptCookies                                          â”‚
â”‚  â”œâ”€ VerifyCsrfToken                                         â”‚
â”‚  â”œâ”€ Authenticate (auth.blade.php)                           â”‚
â”‚  â”œâ”€ ThrottleRequests                                        â”‚
â”‚  â”œâ”€ TrimStrings                                             â”‚
â”‚  â””â”€ ConvertEmptyStringsToNull                               â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Deployment Pipeline (Railway)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Git Push        â”‚
â”‚  (main branch)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GitHub Webhook   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Railway Build Process                   â”‚
â”‚                                          â”‚
â”‚  1. Detect: PHP + Composer               â”‚
â”‚  2. Build: composer install --no-dev     â”‚
â”‚  3. Cache: config:cache + route:cache    â”‚
â”‚  4. Done!                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Railway Deploy                          â”‚
â”‚                                          â”‚
â”‚  1. Release: migrations                  â”‚
â”‚  2. Web: heroku-php-apache2              â”‚
â”‚  3. Health check                         â”‚
â”‚  4. Live!                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Your App Lives! â”‚
â”‚  https://...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Database Relationships

```
PRODUTOS â”€â”€â”¬â”€â”€ ITENS_ESTOQUE
           â”‚   â””â”€ one-to-many
           â”‚
           â”œâ”€â”€ ITENS_PATRIMONIAIS
           â”‚   â””â”€ one-to-many
           â”‚
           â”œâ”€â”€ CATEGORIAS
           â”‚   â””â”€ many-to-one
           â”‚
           â””â”€â”€ UNIDADES
               â””â”€ many-to-one

CAUTELAS â”€â”€â”¬â”€â”€ CAUTELA_PRODUTO
           â”‚   â””â”€ one-to-many
           â”‚
           â””â”€â”€ PRODUTOS
               â””â”€ many-to-many (through cautela_produto)

ITENS_ESTOQUE â”€â”€â”¬â”€â”€ SECOES
                â”‚   â””â”€ many-to-one
                â”‚
                â””â”€â”€ CAUTELAS
                    â””â”€ many-to-many (via quantidade_cautelada)
```

## ğŸ¯ Current Capabilities

âœ… **Inventory Management**
  - Track consumable items (itens_estoque)
  - Track permanent assets (itens_patrimoniais)
  - Unified visualization (UNION query)
  - Automatic aggregation by product

âœ… **Stock Movement**
  - Entry of new items
  - Transfer between sections
  - Cautelas (item borrowing)
  - Return tracking

âœ… **Reporting**
  - PDF generation for cautelas
  - Value calculations
  - Location tracking
  - Quantity summaries

âœ… **User Features**
  - Login/Authentication
  - Role-based access
  - Responsive design
  - Real-time calculations

---

**Architecture Version:** 2.0 (Unified)
**Database:** PostgreSQL (Railway) / MySQL (Local)
**Framework:** Laravel 10.10+
**PHP Version:** 8.3.16 (ZTS)
**Status:** Production Ready âœ…
